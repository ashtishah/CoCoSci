
<!DOCTYPE html>
<html>
    <head>
        <title>My experiment</title>
        <script src="jspsych-6.1.0/jspsych.js"></script>
        <script src="jspsych-6.1.0/plugins/jspsych-html-keyboard-response.js"></script>
        <script src="jspsych-6.1.0/plugins/jspsych-image-keyboard-response.js"></script>
        <link href="jspsych-6.1.0/css/jspsych.css" rel="stylesheet" type="text/css"></link>
    </head>
    <body></body>
    <script>

    /* TODO:
    MTURK Integration:
    - write wrapper in psiturk to integrate with MTURK

    EXPERIMENT LEVEL:
    - code training trials
    - write wrapper (or reorganize) to show several sequences

    SEQUENCE LEVEL:
    - present test trials in order specified by a loaded sequence
    - implement self-termination of sequence
    - check how to get desired output:
      - which sequences were shown
      - when each sequence was stopped
      - responses to questions

    TRIAL LEVEL:
    - put timer / time limit during questions
    - adjust choices (spacebar for termination?)
     */



    var timeline = [];
    var welcome = {
      type: "html-keyboard-response",
      stimulus: "<p>Hi! Thanks so much for participating in our experiment! </p>" +
      "<p>Press any key to continue</p>"
    };
    timeline.push(welcome);

      /* define instructions trial */
      var instructions = {
        type: "html-keyboard-response",
        stimulus: "<p>This session will last for 15min.</p>" +
            "<p> In each trial, you will see some symbols appearing one-by-one </p>" +
            "<p> and you will be asked to stop the sequence whenever you can answer" +
            " some questions (more on this later). </p>" +
            "<p> Each sequence is independent from one another. </p>" +
            "<p> You will be paid extra based on the overall number of correct " +
            "responses you give. </p>" +
            "<p> <br /> Letâ€™s try this on some examples before we move on to " +
            "the actual experiment: </p>",

        post_trial_gap: 2000
      };
      timeline.push(instructions);

      /* define symbol trials */
      var test_stimuli = [
        /* stimulus = which image to load, data = marker to distinguish from blank episodes */
        {stimulus: 'symbol1.png', data: {test_part: 'test'}},
        {stimulus: 'symbol2.png', data: {test_part: 'test'}},
        {stimulus: 'symbol3.png', data: {test_part: 'test'}},
      ];

      /* blank period between trials */
      var blank = {
        type: 'html-keyboard-response',
        stimulus: '<p> </p>',
        choices: jsPsych.NO_KEYS,
        trial_duration: 1000,
        data: {test_part: 'blank'}
      }

      /* sample from test_stimuli */
       var symbol = {
         type: "image-keyboard-response",
         stimulus: jsPsych.timelineVariable('stimulus'),
         choices: ['f', 'j']
       }

       /* define sequence procedure */
       var sequence = {
         timeline: [blank, symbol],
         timeline_variables: test_stimuli,
         /* randomize_order: true,
         repetitions: 5 */
       }

       timeline.push(sequence);

       /* ask subjects about predictability of sequence */
       var slider = {
         type: 'html-keyboard-response',
         stimulus: '<p> Rate this sequence from very random (1) to very predictable (4) </p>' +
         ' <br /> INSERT SLIDER ',
         choices: ['1', '2', '3', '4']

         /* put some constraints on how quickly subjects can move through this part, e.g.
         trial_duration: 10000, */
       }

       /* ask subjects to rank which symbol is most likely to follow */
       var ranking = {
         type: 'html-keyboard-response',
         stimulus: '<p> Rank the symbols by which you think would have come next </p>' +
         '<p> (INSERT SYMBOL NAMES) </p>' +
         ' <br /> INSERT RANKING INTERFACE ',
         choices: ['1', '2', '3']

         /* put some constraints on how quickly subjects can move through this part, e.g.
         trial_duration: 10000, */
       }

       /* define questionnaire procedure */
       var questionnaire = {
         timeline: [slider, ranking] /* randomize_order: true,
         repetitions: 5 */
       }
       timeline.push(questionnaire);

    /* start the experiment */
    jsPsych.init({
      timeline: timeline,
      on_finish: function() {
    jsPsych.data.displayData();
    }
    });

    </script>
</html>
